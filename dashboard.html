<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Tag Manager (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6ZP76Y74Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-Q6ZP76Y74Y');
  </script>
  <!-- End Google Tag Manager -->
<title>Healthcare Dashboard Demo | Christie Stephenson Saavedra</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <style>
/* Block Dashboard V3.9 - Deep Ocean Theme */
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: linear-gradient(180deg, #0a192f 0%, #112240 50%, #0a192f 100%);
  min-height: 100vh;
  color: #f8fafc;
  position: relative;
  overflow-x: hidden;
}

@keyframes float {
  0%, 100% { transform: translate(0, 0) scale(1); }
  25% { transform: translate(30px, -30px) scale(1.05); }
  50% { transform: translate(-20px, 20px) scale(0.95); }
  75% { transform: translate(20px, 30px) scale(1.02); }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.portfolio-back-link {
  position: fixed;
  top: 12px;
  left: 12px;
  z-index: 100;
  background: rgba(99, 102, 241, 0.9);
  backdrop-filter: blur(10px);
  color: white;
  width: 40px;
  height: 40px;
  padding: 0;
  border-radius: 10px;
  text-decoration: none;
  font-size: 18px;
  font-weight: 500;
  box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
  transition: all 0.2s;
  border: 1px solid rgba(255,255,255,0.2);
  display: flex;
  align-items: center;
  justify-content: center;
}
.portfolio-back-link:hover {
  background: rgba(99, 102, 241, 1);
  transform: translateY(-2px);
}

.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 64px;
  background: rgba(15, 23, 42, 0.8);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 16px 0 140px;
  z-index: 50;
}

.logo { display: flex; align-items: center; gap: 8px; }

.logo-icon {
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, #6366f1, #8b5cf6);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
}

.logo-text { font-weight: 600; color: #f8fafc; }

.header-actions { display: flex; align-items: center; gap: 8px; }

.header-btn {
  padding: 8px 12px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
  font-family: inherit;
  transition: all 0.2s;
  color: rgba(255, 255, 255, 0.8);
}

.header-btn:hover {
  background: rgba(255, 255, 255, 0.15);
  border-color: rgba(255, 255, 255, 0.2);
}

.view-toggle {
  display: flex;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
  padding: 4px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.view-toggle-btn {
  padding: 6px 12px;
  border: none;
  background: transparent;
  border-radius: 6px;
  cursor: pointer;
  font-size: 13px;
  font-family: inherit;
  color: rgba(255, 255, 255, 0.6);
  transition: all 0.2s;
}

.view-toggle-btn.active {
  background: linear-gradient(135deg, #6366f1, #8b5cf6);
  color: white;
  box-shadow: 0 2px 10px rgba(99, 102, 241, 0.3);
}

.sidebar {
  position: fixed;
  left: 0;
  top: 64px;
  bottom: 0;
  width: 56px;
  background: rgba(15, 23, 42, 0.6);
  backdrop-filter: blur(20px);
  border-right: 1px solid rgba(255, 255, 255, 0.1);
  z-index: 40;
  display: flex;
  flex-direction: column;
}

.nav-btn {
  width: 100%;
  padding: 14px;
  color: rgba(255, 255, 255, 0.5);
  display: flex;
  justify-content: center;
  cursor: pointer;
  border: none;
  background: none;
  font-size: 20px;
  transition: all 0.2s;
}

.nav-btn:hover { color: white; background: rgba(255, 255, 255, 0.1); }

.nav-btn.active {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.8), rgba(79, 70, 229, 0.8));
  color: white;
  box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
}

.main { margin-left: 56px; padding-top: 64px; min-height: 100vh; }
.content { padding: 24px; }

.breadcrumb { display: flex; align-items: center; gap: 8px; margin-bottom: 24px; font-size: 14px; flex-wrap: wrap; }

.breadcrumb-item {
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  color: rgba(255, 255, 255, 0.5);
  background: none;
  border: none;
  font-size: 14px;
  font-family: inherit;
  transition: all 0.15s;
}

.breadcrumb-item:hover { color: rgba(255, 255, 255, 0.9); background: rgba(255, 255, 255, 0.1); }
.breadcrumb-item.active { color: #f8fafc; font-weight: 600; }
.breadcrumb-sep { color: rgba(255, 255, 255, 0.3); }

.page-header { margin-bottom: 24px; display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 16px; }
.page-title { font-size: 24px; font-weight: 700; color: #f8fafc; }
.page-subtitle { color: rgba(255, 255, 255, 0.6); margin-top: 4px; }

.card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 16px; }

.card {
  background: rgba(17, 34, 64, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 20px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  cursor: pointer;
  transition: all 0.2s;
}

.card:hover {
  transform: translateY(-4px);
  background: rgba(22, 44, 80, 0.98);
  border-color: rgba(255, 255, 255, 0.2);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
}

.card.no-hover:hover { transform: none; box-shadow: none; cursor: default; background: rgba(17, 34, 64, 0.95); }

.card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }
.card-title { font-weight: 600; color: #f8fafc; font-size: 16px; }
.card-subtitle { color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-top: 2px; }

.card-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; padding-top: 16px; border-top: 1px solid rgba(255, 255, 255, 0.1); }
.card-stats-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; padding-top: 16px; border-top: 1px solid rgba(255, 255, 255, 0.1); }
.card-stats-5 { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; padding-top: 16px; border-top: 1px solid rgba(255, 255, 255, 0.1); }
.stat-value { font-size: 24px; font-weight: 700; color: #f8fafc; }
.stat-label { font-size: 12px; color: rgba(255, 255, 255, 0.5); }

.util-badge { padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600; display: inline-block; backdrop-filter: blur(10px); }
.util-excellent { background: rgba(34, 197, 94, 0.2); color: #4ade80; border: 1px solid rgba(34, 197, 94, 0.3); }
.util-good { background: rgba(234, 179, 8, 0.2); color: #facc15; border: 1px solid rgba(234, 179, 8, 0.3); }
.util-warning { background: rgba(249, 115, 22, 0.2); color: #fb923c; border: 1px solid rgba(249, 115, 22, 0.3); }
.util-critical { background: rgba(239, 68, 68, 0.2); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.3); }

.tier-badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; border: 2px solid; backdrop-filter: blur(10px); }
.tier-platinum { background: rgba(226, 232, 240, 0.2); border-color: rgba(226, 232, 240, 0.5); color: #e2e8f0; }
.tier-gold { background: rgba(251, 191, 36, 0.2); border-color: rgba(251, 191, 36, 0.5); color: #fbbf24; }
.tier-silver { background: rgba(148, 163, 184, 0.2); border-color: rgba(148, 163, 184, 0.5); color: #94a3b8; }
.tier-bronze { background: rgba(251, 146, 60, 0.2); border-color: rgba(251, 146, 60, 0.5); color: #fb923c; }

.status-badge { padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; display: inline-flex; align-items: center; gap: 4px; }
.status-pending { background: rgba(234, 179, 8, 0.2); color: #facc15; border: 1px solid rgba(234, 179, 8, 0.3); }
.status-review { background: rgba(59, 130, 246, 0.2); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
.status-approved { background: rgba(34, 197, 94, 0.2); color: #4ade80; border: 1px solid rgba(34, 197, 94, 0.3); }
.status-denied { background: rgba(239, 68, 68, 0.2); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.3); }
.status-partial { background: rgba(249, 115, 22, 0.2); color: #fb923c; border: 1px solid rgba(249, 115, 22, 0.3); }

.meta-row { display: flex; gap: 16px; padding-top: 12px; border-top: 1px solid rgba(255, 255, 255, 0.1); font-size: 14px; color: rgba(255, 255, 255, 0.5); flex-wrap: wrap; }

.trend-up { color: #4ade80; }
.trend-down { color: #f87171; }
.trend-stable { color: rgba(255, 255, 255, 0.5); }

.progress-bar { height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 4px; transition: width 0.3s; }
.progress-green { background: linear-gradient(90deg, #22c55e, #4ade80); }
.progress-yellow { background: linear-gradient(90deg, #eab308, #facc15); }
.progress-orange { background: linear-gradient(90deg, #f97316, #fb923c); }
.progress-red { background: linear-gradient(90deg, #dc2626, #f87171); }

.pill { padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; display: inline-flex; align-items: center; gap: 4px; }
.pill-blue { background: rgba(59, 130, 246, 0.2); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
.pill-green { background: rgba(34, 197, 94, 0.2); color: #4ade80; border: 1px solid rgba(34, 197, 94, 0.3); }

.modal-overlay { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px); display: flex; align-items: center; justify-content: center; z-index: 100; padding: 24px; }

.modal {
  background: rgba(15, 23, 42, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.15);
  width: 100%;
  max-width: 500px;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
}

.modal.xlarge { max-width: 900px; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
.modal-title { font-size: 20px; font-weight: 700; color: #f8fafc; }

.modal-close {
  width: 36px;
  height: 36px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  cursor: pointer;
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: rgba(255, 255, 255, 0.6);
  transition: all 0.15s;
}

.modal-close:hover { background: rgba(255, 255, 255, 0.15); color: #f8fafc; }
.modal-body { padding: 24px; overflow-y: auto; flex: 1; color: rgba(255, 255, 255, 0.8); }
.modal-footer { padding: 16px 24px; border-top: 1px solid rgba(255, 255, 255, 0.1); display: flex; justify-content: flex-end; gap: 12px; }

.btn { padding: 10px 16px; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; font-family: inherit; display: inline-flex; align-items: center; gap: 6px; border: none; transition: all 0.2s; }
.btn-primary { background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4); }
.btn-primary:hover { background: linear-gradient(135deg, #4f46e5, #7c3aed); transform: translateY(-1px); }
.btn-secondary { background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.8); border: 1px solid rgba(255, 255, 255, 0.15); }
.btn-secondary:hover { background: rgba(255, 255, 255, 0.15); color: #f8fafc; }

.form-input { width: 100%; padding: 10px 12px; border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 8px; font-size: 14px; font-family: inherit; background: rgba(255, 255, 255, 0.05); color: #f8fafc; }
.form-input:focus { outline: none; border-color: rgba(99, 102, 241, 0.5); background: rgba(255, 255, 255, 0.1); box-shadow: 0 0 20px rgba(99, 102, 241, 0.2); }
.form-input::placeholder { color: rgba(255, 255, 255, 0.4); }

.empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 48px; text-align: center; }
.empty-state-icon { font-size: 48px; margin-bottom: 16px; opacity: 0.5; }
.empty-state-title { font-size: 18px; font-weight: 600; margin-bottom: 8px; color: #f8fafc; }
.empty-state-text { color: rgba(255, 255, 255, 0.5); margin-bottom: 16px; }

.tabs { display: flex; border-bottom: 1px solid rgba(255, 255, 255, 0.1); overflow-x: auto; margin-bottom: 16px; }
.tab-btn { padding: 12px 16px; border: none; background: none; cursor: pointer; font-size: 14px; font-weight: 500; color: rgba(255, 255, 255, 0.5); border-bottom: 2px solid transparent; margin-bottom: -1px; white-space: nowrap; font-family: inherit; transition: all 0.15s; position: relative; }
.tab-btn:hover { color: rgba(255, 255, 255, 0.8); }
.tab-btn.active { color: #a5b4fc; border-bottom-color: #6366f1; }
.tab-badge { position: absolute; top: 6px; right: 6px; min-width: 18px; height: 18px; background: #ef4444; color: white; border-radius: 9px; font-size: 11px; display: flex; align-items: center; justify-content: center; padding: 0 5px; }

.dropdown { position: absolute; top: 100%; right: 0; margin-top: 8px; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px); border-radius: 12px; border: 1px solid rgba(255,255,255,0.15); padding: 8px; min-width: 200px; z-index: 100; }
.dropdown-header { padding: 8px 12px; font-size: 11px; color: rgba(255,255,255,0.4); text-transform: uppercase; letter-spacing: 1px; }
.dropdown-item { width: 100%; padding: 10px 12px; border: none; background: transparent; border-radius: 8px; text-align: left; cursor: pointer; color: #f8fafc; font-size: 14px; font-family: inherit; transition: all 0.15s; }
.dropdown-item:hover { background: rgba(255,255,255,0.1); }
.dropdown-item.active { background: rgba(99, 102, 241, 0.3); }

.surgeon-avatar { width: 48px; height: 48px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.3), rgba(139, 92, 246, 0.3)); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
.surgeon-info { display: flex; align-items: center; gap: 12px; }

.config-section { margin-bottom: 32px; }
.config-title { font-size: 16px; font-weight: 600; margin-bottom: 16px; color: #f8fafc; display: flex; align-items: center; gap: 8px; }
.config-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px; }
.config-item { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 16px; }
.config-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
.config-item-name { font-weight: 500; display: flex; align-items: center; gap: 8px; }
.config-item-desc { font-size: 12px; color: rgba(255,255,255,0.5); }

.slider-container { display: flex; align-items: center; gap: 12px; margin-top: 12px; }
.slider { flex: 1; height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; appearance: none; cursor: pointer; }
.slider::-webkit-slider-thumb { appearance: none; width: 18px; height: 18px; background: linear-gradient(135deg, #6366f1, #8b5cf6); border-radius: 50%; cursor: pointer; }
.slider-value { min-width: 40px; text-align: right; font-weight: 600; color: #a5b4fc; }

.toggle { position: relative; width: 44px; height: 24px; background: rgba(255,255,255,0.1); border-radius: 12px; cursor: pointer; transition: all 0.2s; }
.toggle.active { background: linear-gradient(135deg, #6366f1, #8b5cf6); }
.toggle-knob { position: absolute; top: 2px; left: 2px; width: 20px; height: 20px; background: white; border-radius: 50%; transition: all 0.2s; }
.toggle.active .toggle-knob { left: 22px; }

@media (max-width: 768px) {
  .card-grid { grid-template-columns: 1fr; }
  .header { padding-left: 12px; padding-right: 12px; justify-content: center; }
  .header-actions { gap: 4px; }
  .modal { max-width: 100%; margin: 16px; }
  .card-stats-5 { grid-template-columns: repeat(2, 1fr); gap: 8px; }
  .portfolio-back-link {
    top: 72px;
  }
  .logo { display: none; }
  .header-tabs { 
    gap: 4px; 
    font-size: 12px;
  }
  .header-tabs button { 
    padding: 6px 10px; 
    font-size: 11px;
  }
  .main-content { 
    padding: 130px 12px 24px 12px; 
    margin-left: 0;
  }
  .sidebar { 
    display: none; 
  }
  .ministry-card, .hospital-card, .unit-card, .room-card {
    padding: 16px;
  }
  .ministry-card h3 { font-size: 1.1rem; }
  .ministry-stats { 
    grid-template-columns: repeat(2, 1fr); 
    gap: 8px;
  }
  .ministry-stats > div {
    padding: 8px;
    font-size: 0.85rem;
  }
  .ministry-stats .stat-value {
    font-size: 1.25rem;
  }
  .breadcrumb { 
    flex-wrap: wrap; 
    gap: 4px;
    font-size: 12px;
  }
  .page-header h1 { font-size: 1.5rem; }
  .card { padding: 16px; }
  .card-header { flex-direction: column; gap: 8px; align-items: flex-start; }
}

@media (max-width: 480px) {
  .header-tabs { display: none; }
  .ministry-stats { grid-template-columns: 1fr 1fr; }
  .card-stats-5 { grid-template-columns: 1fr; }
}

#loading { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; color: rgba(255,255,255,0.6); font-size: 16px; }
  </style>
</head>
<body>
  <a href="index.html#cs-dashboard" class="portfolio-back-link" title="Back to Portfolio">â†</a>
  <div id="root"><div id="loading">Loading dashboard...</div></div>
  
  <script type="text/babel">
const { useState, useCallback, createContext, useContext, useMemo } = React;

// ==================== MOCK DATA ====================
const ministries = [
  { id: 'min-001', name: 'Region A', region: 'South', hospitalCount: 4, surgeonCount: 280, avgUtilization: 78, totalBlocks: 1240, atRiskSurgeons: 12 },
  { id: 'min-002', name: 'Region B', region: 'Southeast', hospitalCount: 3, surgeonCount: 210, avgUtilization: 82, totalBlocks: 980, atRiskSurgeons: 5 },
  { id: 'min-003', name: 'Region C', region: 'Midwest', hospitalCount: 3, surgeonCount: 195, avgUtilization: 75, totalBlocks: 890, atRiskSurgeons: 18 },
  { id: 'min-004', name: 'Region D', region: 'Midwest', hospitalCount: 3, surgeonCount: 185, avgUtilization: 71, totalBlocks: 820, atRiskSurgeons: 22 },
  { id: 'min-005', name: 'Region E', region: 'Midwest', hospitalCount: 2, surgeonCount: 140, avgUtilization: 79, totalBlocks: 640, atRiskSurgeons: 8 },
  { id: 'min-006', name: 'Region F', region: 'South', hospitalCount: 3, surgeonCount: 175, avgUtilization: 76, totalBlocks: 780, atRiskSurgeons: 14 },
];

const hospitals = [
  { id: 'hosp-001', ministryId: 'min-001', name: 'Medical Center A', location: 'City A', unitCount: 6, surgeonCount: 85, roomCount: 18, avgUtilization: 81 },
  { id: 'hosp-002', ministryId: 'min-001', name: 'General Hospital B', location: 'City B', unitCount: 8, surgeonCount: 110, roomCount: 24, avgUtilization: 79 },
  { id: 'hosp-003', ministryId: 'min-001', name: 'Regional Medical C', location: 'City C', unitCount: 5, surgeonCount: 55, roomCount: 14, avgUtilization: 65 },
  { id: 'hosp-004', ministryId: 'min-001', name: 'Community Hospital D', location: 'City D', unitCount: 4, surgeonCount: 30, roomCount: 10, avgUtilization: 76 },
  { id: 'hosp-005', ministryId: 'min-002', name: 'Southeast Medical', location: 'City E', unitCount: 5, surgeonCount: 70, roomCount: 16, avgUtilization: 84 },
  { id: 'hosp-006', ministryId: 'min-002', name: 'Coastal Hospital', location: 'City F', unitCount: 6, surgeonCount: 80, roomCount: 20, avgUtilization: 80 },
];

const units = [
  { id: 'unit-001', hospitalId: 'hosp-001', name: 'Orthopedic Surgery', specialty: 'Orthopedics', roomCount: 4, surgeonCount: 18, avgUtilization: 85 },
  { id: 'unit-002', hospitalId: 'hosp-001', name: 'Cardiovascular Surgery', specialty: 'Cardiology', roomCount: 3, surgeonCount: 12, avgUtilization: 88 },
  { id: 'unit-003', hospitalId: 'hosp-001', name: 'General Surgery', specialty: 'General', roomCount: 4, surgeonCount: 20, avgUtilization: 79 },
  { id: 'unit-004', hospitalId: 'hosp-001', name: 'Neurosurgery', specialty: 'Neurology', roomCount: 2, surgeonCount: 8, avgUtilization: 82 },
  { id: 'unit-005', hospitalId: 'hosp-002', name: 'Orthopedic Surgery', specialty: 'Orthopedics', roomCount: 5, surgeonCount: 22, avgUtilization: 81 },
  { id: 'unit-006', hospitalId: 'hosp-002', name: 'General Surgery', specialty: 'General', roomCount: 4, surgeonCount: 18, avgUtilization: 77 },
];

const surgeons = [
  { id: 'surg-001', hospitalId: 'hosp-001', unitId: 'unit-001', name: 'Dr. John Smith', specialty: 'Orthopedics', tier: 'platinum', tierPoints: 94, utilization: 92, totalBlocks: 28, activeDisputes: 1, onTimeRate: 96, caseVolume: 142, turnoverTime: 22, volumeTrend: 'growing' },
  { id: 'surg-002', hospitalId: 'hosp-001', unitId: 'unit-002', name: 'Dr. Jane Wilson', specialty: 'Cardiology', tier: 'gold', tierPoints: 82, utilization: 78, totalBlocks: 24, activeDisputes: 2, onTimeRate: 88, caseVolume: 98, turnoverTime: 28, volumeTrend: 'stable' },
  { id: 'surg-003', hospitalId: 'hosp-001', unitId: 'unit-003', name: 'Dr. Robert Chen', specialty: 'General', tier: 'gold', tierPoints: 79, utilization: 81, totalBlocks: 22, activeDisputes: 0, onTimeRate: 91, caseVolume: 115, turnoverTime: 25, volumeTrend: 'growing' },
  { id: 'surg-004', hospitalId: 'hosp-001', unitId: 'unit-004', name: 'Dr. Emily Davis', specialty: 'Neurology', tier: 'silver', tierPoints: 68, utilization: 72, totalBlocks: 18, activeDisputes: 1, onTimeRate: 85, caseVolume: 76, turnoverTime: 32, volumeTrend: 'declining' },
  { id: 'surg-005', hospitalId: 'hosp-002', unitId: 'unit-005', name: 'Dr. Michael Brown', specialty: 'Orthopedics', tier: 'platinum', tierPoints: 91, utilization: 89, totalBlocks: 30, activeDisputes: 0, onTimeRate: 94, caseVolume: 156, turnoverTime: 20, volumeTrend: 'growing' },
  { id: 'surg-006', hospitalId: 'hosp-002', unitId: 'unit-006', name: 'Dr. Jennifer Lee', specialty: 'General', tier: 'silver', tierPoints: 65, utilization: 68, totalBlocks: 20, activeDisputes: 1, onTimeRate: 82, caseVolume: 88, turnoverTime: 30, volumeTrend: 'declining' },
  { id: 'surg-007', hospitalId: 'hosp-003', unitId: 'unit-001', name: 'Dr. David Park', specialty: 'ENT', tier: 'bronze', tierPoints: 52, utilization: 58, totalBlocks: 15, activeDisputes: 0, onTimeRate: 78, caseVolume: 62, turnoverTime: 35, volumeTrend: 'declining' },
  { id: 'surg-008', hospitalId: 'hosp-004', unitId: 'unit-003', name: 'Dr. Amanda Torres', specialty: 'Urology', tier: 'gold', tierPoints: 77, utilization: 76, totalBlocks: 21, activeDisputes: 0, onTimeRate: 90, caseVolume: 94, turnoverTime: 27, volumeTrend: 'growing' },
  { id: 'surg-009', hospitalId: 'hosp-005', unitId: 'unit-001', name: 'Dr. Kevin Martinez', specialty: 'Orthopedics', tier: 'gold', tierPoints: 80, utilization: 82, totalBlocks: 25, activeDisputes: 0, onTimeRate: 92, caseVolume: 120, turnoverTime: 24, volumeTrend: 'stable' },
  { id: 'surg-010', hospitalId: 'hosp-006', unitId: 'unit-002', name: 'Dr. Sarah Johnson', specialty: 'Cardiology', tier: 'platinum', tierPoints: 92, utilization: 90, totalBlocks: 32, activeDisputes: 0, onTimeRate: 95, caseVolume: 165, turnoverTime: 21, volumeTrend: 'growing' },
];

const disputes = [
  { id: 'DSP-2024-0847', surgeonId: 'surg-001', surgeonName: 'Dr. John Smith', status: 'pending', reason: 'Equipment Failure', creditType: 'Full Credit', blockDate: '2024-12-02', room: 'OR-2', requestedCredit: 100, submittedDate: '2024-12-03', description: 'Robotic arm malfunction prevented scheduled joint replacement surgery.' },
  { id: 'DSP-2024-0845', surgeonId: 'surg-002', surgeonName: 'Dr. Jane Wilson', status: 'review', reason: 'Emergency Case Bump', creditType: 'Partial Credit', blockDate: '2024-11-28', room: 'CV-1', requestedCredit: 75, submittedDate: '2024-11-29', description: 'Elective cardiac procedure was bumped for emergency trauma surgery.' },
  { id: 'DSP-2024-0842', surgeonId: 'surg-002', surgeonName: 'Dr. Jane Wilson', status: 'approved', reason: 'Staffing Shortage', creditType: 'Full Credit', blockDate: '2024-11-20', room: 'CV-2', requestedCredit: 100, submittedDate: '2024-11-21', description: 'No anesthesiologist available for scheduled procedures.' },
  { id: 'DSP-2024-0839', surgeonId: 'surg-004', surgeonName: 'Dr. Emily Davis', status: 'denied', reason: 'Patient Cancellation', creditType: 'Full Credit', blockDate: '2024-11-15', room: 'OR-3', requestedCredit: 100, submittedDate: '2024-11-16', description: 'Patient cancelled day of surgery due to personal reasons.' },
  { id: 'DSP-2024-0836', surgeonId: 'surg-006', surgeonName: 'Dr. Jennifer Lee', status: 'partial', reason: 'Room Turnover Delay', creditType: 'Partial Credit', blockDate: '2024-11-12', room: 'CV-1', requestedCredit: 50, submittedDate: '2024-11-13', description: 'Extended turnover time between cases due to cleaning protocol.' },
];

const alerts = [
  { id: 'alert-001', surgeonId: 'surg-001', type: 'critical', title: 'Critical Utilization Alert', message: 'Block utilization dropped below 60% for 3 consecutive weeks.', time: '2 hours ago', isRead: false },
  { id: 'alert-002', surgeonId: 'surg-006', type: 'warning', title: 'Tier Change Warning', message: 'At risk of dropping from Silver to Bronze tier.', time: '5 hours ago', isRead: false },
  { id: 'alert-003', surgeonId: 'surg-001', type: 'success', title: 'Dispute Approved', message: 'Your dispute DSP-2024-0842 has been approved with full credit.', time: '1 day ago', isRead: true },
  { id: 'alert-004', surgeonId: 'surg-001', type: 'info', title: 'Block Released', message: 'Block on Dec 15 has been released and is available for reassignment.', time: '2 days ago', isRead: true },
  { id: 'alert-005', surgeonId: 'surg-002', type: 'warning', title: 'Low Utilization Warning', message: 'Block utilization is below 70% for the past 2 weeks.', time: '3 hours ago', isRead: false },
  { id: 'alert-006', surgeonId: 'surg-007', type: 'critical', title: 'Tier Drop Alert', message: 'You have dropped to Bronze tier due to low utilization.', time: '1 day ago', isRead: false },
  { id: 'alert-007', surgeonId: 'surg-003', type: 'info', title: 'Schedule Change', message: 'Your block schedule has been updated for next week.', time: '4 hours ago', isRead: true },
  { id: 'alert-008', surgeonId: 'surg-005', type: 'success', title: 'Platinum Status Maintained', message: 'Congratulations! You have maintained Platinum tier this quarter.', time: '2 days ago', isRead: true },
];

const blocks = (() => {
  const blockList = [];
  const roomOptions = ['OR-1', 'OR-2', 'OR-3', 'CV-1', 'CV-2', 'GS-1', 'GS-2'];
  const today = new Date();
  surgeons.forEach(surgeon => {
    for (let i = -30; i < 15; i++) {
      if (Math.random() > 0.6) continue;
      const blockDate = new Date(today);
      blockDate.setDate(blockDate.getDate() + i);
      if (blockDate.getDay() === 0 || blockDate.getDay() === 6) continue;
      const isPast = i < 0;
      const startHour = 7 + Math.floor(Math.random() * 3);
      const duration = 3 + Math.floor(Math.random() * 3);
      blockList.push({
        id: `block-${surgeon.id}-${i}`,
        surgeonId: surgeon.id,
        date: blockDate.toISOString().split('T')[0],
        startTime: `${startHour.toString().padStart(2, '0')}:00`,
        endTime: `${(startHour + duration).toString().padStart(2, '0')}:00`,
        room: roomOptions[Math.floor(Math.random() * roomOptions.length)],
        utilization: isPast ? Math.max(40, Math.min(100, surgeon.utilization + Math.floor(Math.random() * 20) - 10)) : null,
        caseCount: isPast ? 2 + Math.floor(Math.random() * 4) : 2 + Math.floor(Math.random() * 3),
        isPast,
      });
    }
  });
  return blockList;
})();

const roles = [
  { id: 'super-user', name: 'Super User', description: 'Full system access with configuration capabilities' },
  { id: 'administrator', name: 'Administrator', description: 'Manage users, disputes, and system settings' },
  { id: 'director', name: 'Director', description: 'Read-only access to all data and analytics' },
  { id: 'scheduler', name: 'Scheduler', description: 'Create and manage surgical blocks' },
  { id: 'physician', name: 'Physician', description: 'View own profile and file disputes' },
];

const metricsConfig = [
  { id: 'utilization', name: 'Utilization Rate', icon: 'ðŸ“Š', weight: 35, enabled: true, description: 'Percentage of allocated block time actually used' },
  { id: 'case-volume', name: 'Case Volume', icon: 'ðŸ“ˆ', weight: 20, enabled: true, description: 'Number of surgical cases completed per block' },
  { id: 'block-adherence', name: 'Block Adherence', icon: 'âœ…', weight: 15, enabled: true, description: 'Percentage of scheduled blocks actually used' },
  { id: 'on-time-starts', name: 'On-Time Starts', icon: 'â°', weight: 15, enabled: true, description: 'Percentage of cases starting on time' },
  { id: 'turnover-time', name: 'Turnover Time', icon: 'ðŸ”„', weight: 10, enabled: true, description: 'Average time between cases' },
  { id: 'cancellation-rate', name: 'Cancellation Rate', icon: 'âŒ', weight: 5, enabled: true, description: 'Percentage of cancelled cases' },
];

const currentUser = { id: 'user-001', surgeonId: 'surg-001', name: 'Dr. John Smith' };

// ==================== UTILITIES ====================
const getUtilClass = u => u >= 80 ? 'util-excellent' : u >= 70 ? 'util-good' : u >= 60 ? 'util-warning' : 'util-critical';
const getTierIcon = t => ({ platinum: 'ðŸ†', gold: 'ðŸ¥‡', silver: 'ðŸ¥ˆ', bronze: 'ðŸ¥‰' }[t] || '');
const getTrendClass = t => ({ growing: 'trend-up', declining: 'trend-down', stable: 'trend-stable' }[t] || 'trend-stable');
const getTrendIcon = t => ({ growing: 'ðŸ“ˆ', declining: 'ðŸ“‰', stable: 'âž¡ï¸' }[t] || 'âž¡ï¸');
const getProgressClass = u => u >= 80 ? 'progress-green' : u >= 70 ? 'progress-yellow' : u >= 60 ? 'progress-orange' : 'progress-red';
const capitalize = s => s.charAt(0).toUpperCase() + s.slice(1);
const formatTime = t => { const [h, m] = t.split(':'); const hr = parseInt(h); return `${hr % 12 || 12}:${m} ${hr >= 12 ? 'PM' : 'AM'}`; };
const getHeatmapColor = u => u === null ? { bg: 'rgba(59,130,246,0.2)', text: '#60a5fa' } : u >= 80 ? { bg: 'rgba(34,197,94,0.2)', text: '#4ade80' } : u >= 70 ? { bg: 'rgba(234,179,8,0.2)', text: '#facc15' } : u >= 60 ? { bg: 'rgba(249,115,22,0.2)', text: '#fb923c' } : { bg: 'rgba(239,68,68,0.2)', text: '#f87171' };

// ==================== CONTEXT ====================
const NavigationContext = createContext();
const RoleContext = createContext();

function NavigationProvider({ children }) {
  const [nav, setNav] = useState({ level: 'ministries', ministryId: null, hospitalId: null, unitId: null, surgeonId: null });

  const navigate = useCallback((level, id) => {
    setNav(prev => {
      const newNav = { ...prev, level };
      if (level === 'ministries') return { level: 'ministries', ministryId: null, hospitalId: null, unitId: null, surgeonId: null };
      if (level === 'all-hospitals') return { level: 'all-hospitals', ministryId: null, hospitalId: null, unitId: null, surgeonId: null };
      if (level === 'all-surgeons') return { level: 'all-surgeons', ministryId: null, hospitalId: null, unitId: null, surgeonId: null };
      if (level === 'hospitals') { newNav.ministryId = id || prev.ministryId; newNav.hospitalId = null; newNav.unitId = null; newNav.surgeonId = null; }
      if (level === 'hospital-detail') { newNav.hospitalId = id || prev.hospitalId; newNav.unitId = null; newNav.surgeonId = null; }
      if (level === 'units') { newNav.hospitalId = id || prev.hospitalId; }
      if (level === 'surgeons') { newNav.hospitalId = id || prev.hospitalId; newNav.surgeonId = null; }
      if (level === 'surgeon-detail') { newNav.surgeonId = id || prev.surgeonId; }
      return newNav;
    });
  }, []);

  const getBreadcrumbs = useCallback(() => {
    const crumbs = [{ label: 'Ministries', level: 'ministries' }];
    if (nav.level === 'all-hospitals') return [{ label: 'All Hospitals', level: 'all-hospitals' }];
    if (nav.level === 'all-surgeons') return [{ label: 'All Surgeons', level: 'all-surgeons' }];
    if (nav.ministryId) { const m = ministries.find(x => x.id === nav.ministryId); crumbs.push({ label: m?.name || 'Ministry', level: 'hospitals', id: nav.ministryId }); }
    if (nav.hospitalId) { const h = hospitals.find(x => x.id === nav.hospitalId); crumbs.push({ label: h?.name || 'Hospital', level: 'hospital-detail', id: nav.hospitalId }); }
    if (nav.level === 'surgeons' || nav.level === 'surgeon-detail') crumbs.push({ label: 'Surgeons', level: 'surgeons', id: nav.hospitalId });
    if (nav.level === 'units') crumbs.push({ label: 'Units', level: 'units', id: nav.hospitalId });
    if (nav.surgeonId) { const s = surgeons.find(x => x.id === nav.surgeonId); crumbs.push({ label: s?.name || 'Surgeon', level: 'surgeon-detail', id: nav.surgeonId }); }
    return crumbs;
  }, [nav]);

  return <NavigationContext.Provider value={{ nav, navigate, getBreadcrumbs }}>{children}</NavigationContext.Provider>;
}

function useNavigation() { return useContext(NavigationContext); }

function RoleProvider({ children }) {
  const [currentRole, setCurrentRole] = useState('super-user');
  const isPhysician = currentRole === 'physician';
  const isDirector = currentRole === 'director';
  const isSuperUser = currentRole === 'super-user';
  return <RoleContext.Provider value={{ currentRole, setRole: setCurrentRole, isPhysician, isDirector, isSuperUser }}>{children}</RoleContext.Provider>;
}

function useRole() { return useContext(RoleContext); }

// ==================== COMPONENTS ====================
function Header({ viewMode, onViewModeChange, onSearchOpen, onHeatMapOpen, onSettingsOpen }) {
  const { currentRole, setRole } = useRole();
  const [showRoleDropdown, setShowRoleDropdown] = useState(false);

  return (
    <header className="header">
      <div className="logo">
        <div className="logo-icon">A</div>
        <span className="logo-text">Block Management</span>
        <span style={{ fontSize: 12, color: '#94a3b8', marginLeft: 4 }}>v3.9</span>
      </div>
      <div className="header-actions">
        <div className="view-toggle">
          <button className={`view-toggle-btn ${viewMode === 'explorer' ? 'active' : ''}`} onClick={() => onViewModeChange('explorer')}>ðŸ“Š Explorer</button>
          <button className={`view-toggle-btn ${viewMode === 'calendar' ? 'active' : ''}`} onClick={() => onViewModeChange('calendar')}>ðŸ“… Calendar</button>
        </div>
        <button className="header-btn" onClick={onSearchOpen}>ðŸ” Search</button>
        <button className="header-btn" onClick={onHeatMapOpen}>ðŸ“Š Heat Map</button>
        <button className="header-btn" onClick={onSettingsOpen}>âš™ï¸ Settings</button>
        <div style={{ position: 'relative' }}>
          <button className="header-btn" onClick={() => setShowRoleDropdown(!showRoleDropdown)}>ðŸ‘¤ {capitalize(currentRole.replace('-', ' '))}</button>
          {showRoleDropdown && (
            <div className="dropdown">
              <div className="dropdown-header">Switch Role (Demo)</div>
              {roles.map(role => (
                <button key={role.id} className={`dropdown-item ${currentRole === role.id ? 'active' : ''}`} onClick={() => { setRole(role.id); setShowRoleDropdown(false); }}>
                  {role.name}
                  <div style={{ fontSize: 11, color: 'rgba(255,255,255,0.5)', marginTop: 2 }}>{role.description}</div>
                </button>
              ))}
            </div>
          )}
        </div>
      </div>
    </header>
  );
}

function Sidebar({ onSettingsOpen }) {
  const { nav, navigate } = useNavigation();
  const navItems = [
    { icon: 'ðŸ›ï¸', level: 'ministries', label: 'Ministries' },
    { icon: 'ðŸ¥', level: 'all-hospitals', label: 'All Hospitals' },
    { icon: 'ðŸ‘¨"âš•ï¸', level: 'all-surgeons', label: 'All Surgeons' },
  ];

  return (
    <aside className="sidebar">
      {navItems.map(item => (
        <button key={item.level} className={`nav-btn ${nav.level === item.level ? 'active' : ''}`} onClick={() => navigate(item.level)} title={item.label}>{item.icon}</button>
      ))}
      <div style={{ marginTop: 'auto' }}>
        <button className="nav-btn" onClick={onSettingsOpen} title="Settings">âš™ï¸</button>
        <div style={{ fontSize: '9px', color: 'rgba(255,255,255,0.3)', textAlign: 'center', padding: '8px 4px', lineHeight: 1.3 }}>© 2025<br/>Christie S.</div>
      </div>
    </aside>
  );
}

function Breadcrumb() {
  const { getBreadcrumbs, navigate } = useNavigation();
  const crumbs = getBreadcrumbs();
  if (crumbs.length <= 1) return null;
  return (
    <nav className="breadcrumb">
      {crumbs.map((crumb, i) => (
        <React.Fragment key={i}>
          {i > 0 && <span className="breadcrumb-sep">"º</span>}
          <button className={`breadcrumb-item ${i === crumbs.length - 1 ? 'active' : ''}`} onClick={() => navigate(crumb.level, crumb.id)}>{crumb.label}</button>
        </React.Fragment>
      ))}
    </nav>
  );
}

function MinistryCard({ ministry, onClick }) {
  return (
    <div className="card" onClick={onClick}>
      <div className="card-header">
        <div><div className="card-title">{ministry.name}</div><div className="card-subtitle">{ministry.region} Region</div></div>
        <span className={`util-badge ${getUtilClass(ministry.avgUtilization)}`}>{ministry.avgUtilization}%</span>
      </div>
      <div className="card-stats-4">
        <div><div className="stat-value">{ministry.hospitalCount}</div><div className="stat-label">Hospitals</div></div>
        <div><div className="stat-value">{ministry.surgeonCount}</div><div className="stat-label">Surgeons</div></div>
        <div><div className="stat-value">{ministry.totalBlocks}</div><div className="stat-label">Blocks</div></div>
        <div><div className="stat-value" style={{ color: ministry.atRiskSurgeons > 10 ? '#f87171' : '#94a3b8' }}>{ministry.atRiskSurgeons}</div><div className="stat-label">At Risk</div></div>
      </div>
    </div>
  );
}

function HospitalCard({ hospital, onClick }) {
  return (
    <div className="card" onClick={onClick}>
      <div className="card-header">
        <div><div className="card-title">{hospital.name}</div><div className="card-subtitle">{hospital.location}</div></div>
        <span className={`util-badge ${getUtilClass(hospital.avgUtilization)}`}>{hospital.avgUtilization}%</span>
      </div>
      <div className="meta-row"><span>{hospital.unitCount} Units</span><span>{hospital.surgeonCount} Surgeons</span><span>{hospital.roomCount} ORs</span></div>
    </div>
  );
}

function UnitCard({ unit, onClick }) {
  return (
    <div className="card" onClick={onClick}>
      <div className="card-header">
        <div><div className="card-title">{unit.name}</div><div className="card-subtitle">{unit.specialty}</div></div>
        <span className={`util-badge ${getUtilClass(unit.avgUtilization)}`}>{unit.avgUtilization}%</span>
      </div>
      <div className="meta-row"><span>{unit.roomCount} Rooms</span><span>{unit.surgeonCount} Surgeons</span></div>
    </div>
  );
}

function SurgeonCard({ surgeon, onClick }) {
  return (
    <div className="card" onClick={onClick}>
      <div className="card-header">
        <div className="surgeon-info">
          <div className="surgeon-avatar">ðŸ‘¨"âš•ï¸</div>
          <div><div className="card-title">{surgeon.name}</div><div className="card-subtitle">{surgeon.specialty}</div></div>
        </div>
        <div style={{ textAlign: 'right' }}>
          <span className={`tier-badge tier-${surgeon.tier}`}>{getTierIcon(surgeon.tier)} {capitalize(surgeon.tier)}</span>
          <div className={`trend-badge ${getTrendClass(surgeon.volumeTrend)}`} style={{ marginTop: 6, justifyContent: 'flex-end', fontSize: 11 }}>{getTrendIcon(surgeon.volumeTrend)} {surgeon.volumeTrend}</div>
        </div>
      </div>
      <div style={{ marginTop: 16, paddingTop: 12, borderTop: '1px solid rgba(255,255,255,0.1)' }}>
        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 8 }}>
          <span style={{ fontSize: 14, color: 'rgba(255,255,255,0.6)' }}>Block Utilization</span>
          <span className={`util-badge ${getUtilClass(surgeon.utilization)}`}>{surgeon.utilization}%</span>
        </div>
        <div className="progress-bar"><div className={`progress-fill ${getProgressClass(surgeon.utilization)}`} style={{ width: `${surgeon.utilization}%` }} /></div>
      </div>
      <div style={{ display: 'flex', gap: 16, marginTop: 12, fontSize: 14, color: 'rgba(255,255,255,0.5)' }}>
        <span>{surgeon.totalBlocks} Blocks</span>
        {surgeon.activeDisputes > 0 && <span style={{ color: '#fb923c' }}>{surgeon.activeDisputes} Disputes</span>}
      </div>
    </div>
  );
}

function BlockCalendarTab({ surgeonBlocks }) {
  const recentBlocks = surgeonBlocks.slice(0, 12);
  if (recentBlocks.length === 0) return <div className="empty-state"><div className="empty-state-icon">ðŸ“…</div><div className="empty-state-title">No Blocks</div></div>;
  return (
    <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>
      {recentBlocks.map(block => {
        const colors = getHeatmapColor(block.utilization);
        return (
          <div key={block.id} style={{ padding: 12, borderRadius: 8, background: colors.bg, borderLeft: `4px solid ${block.utilization !== null ? colors.text : '#60a5fa'}`, display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
            <div>
              <div style={{ fontWeight: 600, color: '#f8fafc' }}>{block.date}</div>
              <div style={{ fontSize: 13, color: 'rgba(255,255,255,0.6)' }}>{formatTime(block.startTime)} - {formatTime(block.endTime)} "¢ {block.room}</div>
            </div>
            <div style={{ textAlign: 'right' }}>
              {block.utilization !== null ? <div style={{ fontWeight: 700, color: colors.text }}>{block.utilization}%</div> : <span className="pill pill-blue">Scheduled</span>}
              <div style={{ fontSize: 12, color: 'rgba(255,255,255,0.5)' }}>{block.caseCount} cases</div>
            </div>
          </div>
        );
      })}
    </div>
  );
}

function AlertsTab({ surgeonAlerts }) {
  if (surgeonAlerts.length === 0) return <div className="empty-state"><div className="empty-state-icon">âœ…</div><div className="empty-state-title">No Alerts</div><div className="empty-state-text">No active alerts for this surgeon</div></div>;
  const getAlertStyle = type => ({ critical: { bg: 'rgba(239,68,68,0.2)', border: '#f87171', icon: 'ðŸ”´' }, warning: { bg: 'rgba(234,179,8,0.2)', border: '#facc15', icon: 'âš ï¸' }, success: { bg: 'rgba(34,197,94,0.2)', border: '#4ade80', icon: 'âœ…' }, info: { bg: 'rgba(59,130,246,0.2)', border: '#60a5fa', icon: 'â„¹ï¸' } }[type] || { bg: 'rgba(59,130,246,0.2)', border: '#60a5fa', icon: 'â„¹ï¸' });
  return (
    <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>
      {surgeonAlerts.map(alert => {
        const style = getAlertStyle(alert.type);
        return (
          <div key={alert.id} style={{ display: 'flex', gap: 12, padding: 16, borderRadius: 8, borderLeft: `4px solid ${style.border}`, background: style.bg }}>
            <span style={{ fontSize: 20 }}>{style.icon}</span>
            <div style={{ flex: 1 }}>
              <div style={{ fontWeight: 600, marginBottom: 4, color: '#f8fafc' }}>{alert.title}</div>
              <div style={{ fontSize: 13, color: 'rgba(255,255,255,0.7)' }}>{alert.message}</div>
              <div style={{ fontSize: 12, color: 'rgba(255,255,255,0.5)', marginTop: 8 }}>{alert.time}</div>
            </div>
          </div>
        );
      })}
    </div>
  );
}

function DisputesTab({ surgeonDisputes }) {
  if (surgeonDisputes.length === 0) return <div className="empty-state"><div className="empty-state-icon">ðŸ“</div><div className="empty-state-title">No Disputes</div><div className="empty-state-text">No disputes have been filed</div></div>;
  return (
    <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>
      {surgeonDisputes.map(dispute => (
        <div key={dispute.id} style={{ padding: 16, borderRadius: 8, border: '1px solid rgba(255,255,255,0.15)', background: 'rgba(255,255,255,0.05)' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 8 }}>
            <span style={{ fontWeight: 700, color: '#f8fafc' }}>{dispute.id}</span>
            <span className={`status-badge status-${dispute.status}`}>{capitalize(dispute.status)}</span>
          </div>
          <div style={{ fontSize: 14, color: 'rgba(255,255,255,0.7)', marginBottom: 4 }}>{dispute.reason}</div>
          <div style={{ fontSize: 13, color: 'rgba(255,255,255,0.5)' }}>{dispute.blockDate} "¢ {dispute.room} "¢ {dispute.creditType}</div>
        </div>
      ))}
    </div>
  );
}

function SurgeonProfile({ surgeon }) {
  const [activeTab, setActiveTab] = useState('calendar');
  const surgeonBlocks = blocks.filter(b => b.surgeonId === surgeon.id);
  const surgeonDisputes = disputes.filter(d => d.surgeonId === surgeon.id);
  const surgeonAlerts = alerts.filter(a => a.surgeonId === surgeon.id);

  const tabs = [
    { id: 'calendar', label: 'ðŸ“… Calendar' },
    { id: 'timeline', label: 'ðŸ“ˆ Timeline' },
    { id: 'bar-chart', label: 'ðŸ“Š Bar Chart' },
    { id: 'distribution', label: 'ðŸ© Distribution' },
    { id: 'alerts', label: 'ðŸ”” Alerts', badge: surgeonAlerts.filter(a => !a.isRead).length },
    { id: 'disputes', label: 'âš–ï¸ Disputes', badge: surgeonDisputes.filter(d => d.status === 'pending' || d.status === 'review').length },
  ];

  return (
    <div>
      <div className="card no-hover" style={{ marginBottom: 24 }}>
        <div style={{ display: 'flex', gap: 24, alignItems: 'flex-start', flexWrap: 'wrap' }}>
          <div className="surgeon-avatar" style={{ width: 80, height: 80, fontSize: 40 }}>ðŸ‘¨"âš•ï¸</div>
          <div style={{ flex: 1, minWidth: 200 }}>
            <h1 style={{ fontSize: 24, fontWeight: 700, marginBottom: 4 }}>{surgeon.name}</h1>
            <p style={{ color: 'rgba(255,255,255,0.6)', marginBottom: 12 }}>{surgeon.specialty} "¢ {hospitals.find(h => h.id === surgeon.hospitalId)?.name}</p>
            <div style={{ display: 'flex', gap: 12, alignItems: 'center', flexWrap: 'wrap' }}>
              <span className={`tier-badge tier-${surgeon.tier}`}>{getTierIcon(surgeon.tier)} {capitalize(surgeon.tier)} "¢ {surgeon.tierPoints} pts</span>
              <span className={`util-badge ${getUtilClass(surgeon.utilization)}`}>{surgeon.utilization}% Utilization</span>
            </div>
          </div>
          <div className="card-stats-5" style={{ border: 'none', paddingTop: 0, textAlign: 'center' }}>
            <div><div className="stat-value">{surgeon.totalBlocks}</div><div className="stat-label">Blocks</div></div>
            <div><div className="stat-value">{surgeon.caseVolume}</div><div className="stat-label">Cases</div></div>
            <div><div className="stat-value">{surgeon.onTimeRate}%</div><div className="stat-label">On-Time</div></div>
            <div><div className="stat-value">{surgeon.turnoverTime}m</div><div className="stat-label">Turnover</div></div>
            <div><div className="stat-value" style={{ color: surgeon.activeDisputes > 0 ? '#fb923c' : '#f8fafc' }}>{surgeon.activeDisputes}</div><div className="stat-label">Disputes</div></div>
          </div>
        </div>
      </div>

      <div className="tabs">
        {tabs.map(tab => (
          <button key={tab.id} className={`tab-btn ${activeTab === tab.id ? 'active' : ''}`} onClick={() => setActiveTab(tab.id)}>
            {tab.label}
            {tab.badge > 0 && <span className="tab-badge">{tab.badge}</span>}
          </button>
        ))}
      </div>

      <div className="card no-hover" style={{ padding: 24 }}>
        {activeTab === 'calendar' && <BlockCalendarTab surgeonBlocks={surgeonBlocks} />}
        {activeTab === 'alerts' && <AlertsTab surgeonAlerts={surgeonAlerts} />}
        {activeTab === 'disputes' && <DisputesTab surgeonDisputes={surgeonDisputes} />}
        {activeTab === 'timeline' && <div className="empty-state"><div className="empty-state-icon">ðŸ“ˆ</div><div className="empty-state-title">Timeline Chart</div><div className="empty-state-text">Utilization trend over time</div></div>}
        {activeTab === 'bar-chart' && <div className="empty-state"><div className="empty-state-icon">ðŸ“Š</div><div className="empty-state-title">Performance Metrics</div><div className="empty-state-text">Bar chart comparison</div></div>}
        {activeTab === 'distribution' && <div className="empty-state"><div className="empty-state-icon">ðŸ©</div><div className="empty-state-title">Block Distribution</div><div className="empty-state-text">Donut chart of block usage</div></div>}
      </div>
    </div>
  );
}

function SettingsModal({ onClose }) {
  const [metrics, setMetrics] = useState(metricsConfig);
  const [thresholds, setThresholds] = useState({ platinum: 85, gold: 70, silver: 55 });
  const [reportType, setReportType] = useState('utilization');
  const [reportRange, setReportRange] = useState('month');
  const [reportGenerating, setReportGenerating] = useState(false);
  const [reportGenerated, setReportGenerated] = useState(false);
  const totalWeight = metrics.filter(m => m.enabled).reduce((sum, m) => sum + m.weight, 0);

  const handleGenerateReport = () => {
    setReportGenerating(true);
    setTimeout(() => {
      setReportGenerating(false);
      setReportGenerated(true);
      setTimeout(() => setReportGenerated(false), 3000);
    }, 1500);
  };

  return (
    <div className="modal-overlay" onClick={onClose}>
      <div className="modal xlarge" onClick={e => e.stopPropagation()} style={{ maxHeight: '90vh' }}>
        <div className="modal-header">
          <div className="modal-title">âš™ï¸ Settings & Configuration</div>
          <button className="modal-close" onClick={onClose}>Ã—</button>
        </div>
        <div className="modal-body">
          <div className="config-section">
            <div className="config-title">ðŸ“Š Metric Weights <span style={{ fontSize: 12, fontWeight: 400, color: totalWeight === 100 ? '#4ade80' : '#f87171' }}>Total: {totalWeight}%</span></div>
            <div className="config-grid">
              {metrics.map(metric => (
                <div key={metric.id} className="config-item">
                  <div className="config-item-header">
                    <div className="config-item-name">{metric.icon} {metric.name}</div>
                    <div className="toggle" style={{ background: metric.enabled ? 'linear-gradient(135deg, #6366f1, #8b5cf6)' : 'rgba(255,255,255,0.1)' }} onClick={() => setMetrics(metrics.map(m => m.id === metric.id ? { ...m, enabled: !m.enabled } : m))}>
                      <div className="toggle-knob" style={{ left: metric.enabled ? 22 : 2 }} />
                    </div>
                  </div>
                  <div className="config-item-desc">{metric.description}</div>
                  {metric.enabled && (
                    <div className="slider-container">
                      <input type="range" className="slider" min="0" max="50" value={metric.weight} onChange={e => setMetrics(metrics.map(m => m.id === metric.id ? { ...m, weight: parseInt(e.target.value) } : m))} />
                      <div className="slider-value">{metric.weight}%</div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          </div>

          <div className="config-section">
            <div className="config-title">ðŸ† Tier Thresholds</div>
            <div className="config-grid">
              {Object.entries(thresholds).map(([tier, value]) => (
                <div key={tier} className="config-item">
                  <div className="config-item-header">
                    <div className="config-item-name"><span className={`tier-badge tier-${tier}`}>{getTierIcon(tier)} {capitalize(tier)}</span></div>
                  </div>
                  <div className="slider-container">
                    <input type="range" className="slider" min="0" max="100" value={value} onChange={e => setThresholds({ ...thresholds, [tier]: parseInt(e.target.value) })} />
                    <div className="slider-value">{value}+</div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <div className="config-section">
            <div className="config-title">ðŸ“‹ Create Reports</div>
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: 16 }}>
              <div className="config-item">
                <div className="config-item-name" style={{ marginBottom: 8 }}>Report Type</div>
                <select 
                  value={reportType} 
                  onChange={e => setReportType(e.target.value)}
                  style={{ 
                    width: '100%', 
                    padding: '10px 12px', 
                    background: 'rgba(255,255,255,0.1)', 
                    border: '1px solid rgba(255,255,255,0.2)', 
                    borderRadius: 8, 
                    color: '#f8fafc',
                    fontSize: 14,
                    cursor: 'pointer'
                  }}
                >
                  <option value="utilization" style={{ background: '#1e293b' }}>Utilization Summary</option>
                  <option value="surgeon" style={{ background: '#1e293b' }}>Surgeon Performance</option>
                  <option value="tier" style={{ background: '#1e293b' }}>Tier Distribution</option>
                  <option value="dispute" style={{ background: '#1e293b' }}>Dispute Summary</option>
                  <option value="block" style={{ background: '#1e293b' }}>Block Analysis</option>
                  <option value="trend" style={{ background: '#1e293b' }}>Trend Report</option>
                </select>
              </div>
              <div className="config-item">
                <div className="config-item-name" style={{ marginBottom: 8 }}>Time Range</div>
                <select 
                  value={reportRange} 
                  onChange={e => setReportRange(e.target.value)}
                  style={{ 
                    width: '100%', 
                    padding: '10px 12px', 
                    background: 'rgba(255,255,255,0.1)', 
                    border: '1px solid rgba(255,255,255,0.2)', 
                    borderRadius: 8, 
                    color: '#f8fafc',
                    fontSize: 14,
                    cursor: 'pointer'
                  }}
                >
                  <option value="week" style={{ background: '#1e293b' }}>Last 7 Days</option>
                  <option value="month" style={{ background: '#1e293b' }}>Last 30 Days</option>
                  <option value="quarter" style={{ background: '#1e293b' }}>Last Quarter</option>
                  <option value="year" style={{ background: '#1e293b' }}>Last Year</option>
                  <option value="custom" style={{ background: '#1e293b' }}>Custom Range</option>
                </select>
              </div>
            </div>
            <div style={{ marginTop: 16, display: 'flex', gap: 12, alignItems: 'center' }}>
              <button 
                className="btn btn-primary" 
                onClick={handleGenerateReport}
                disabled={reportGenerating}
                style={{ 
                  display: 'flex', 
                  alignItems: 'center', 
                  gap: 8,
                  opacity: reportGenerating ? 0.7 : 1 
                }}
              >
                {reportGenerating ? (
                  <>
                    <span style={{ animation: 'spin 1s linear infinite', display: 'inline-block' }}>â³</span>
                    Generating...
                  </>
                ) : (
                  <>ðŸ“Š Generate Report</>
                )}
              </button>
              <button className="btn btn-secondary" style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
                ðŸ“… Schedule Report
              </button>
              {reportGenerated && (
                <span style={{ color: '#4ade80', fontSize: 14, display: 'flex', alignItems: 'center', gap: 6 }}>
                  âœ“ Report ready for download
                </span>
              )}
            </div>
            <div style={{ marginTop: 16, padding: 12, background: 'rgba(255,255,255,0.05)', borderRadius: 8, fontSize: 13, color: 'rgba(255,255,255,0.6)' }}>
              <strong style={{ color: 'rgba(255,255,255,0.8)' }}>Available Formats:</strong> PDF, Excel (.xlsx), CSV
            </div>
          </div>
          
          <div className="config-section">
            <div className="config-title">â„¹ï¸ About This Demo</div>
            <div style={{ padding: 16, background: 'rgba(255,255,255,0.03)', borderRadius: 12, border: '1px solid rgba(255,255,255,0.1)' }}>
              <p style={{ margin: '0 0 12px 0', fontSize: 14, color: 'rgba(255,255,255,0.8)' }}>
                <strong>Healthcare Dashboard Demo</strong><br/>
                <span style={{ color: 'rgba(255,255,255,0.5)' }}>OCM Portfolio Piece - Operating Room Block Scheduling Analytics</span>
              </p>
              <p style={{ margin: '0 0 12px 0', fontSize: 13, color: 'rgba(255,255,255,0.6)' }}>
                Demonstrates strategic change management approach: stakeholder communication, 
                role-based interfaces, and data-driven decision support.
              </p>
              <div style={{ paddingTop: 12, borderTop: '1px solid rgba(255,255,255,0.1)', fontSize: 12, color: 'rgba(255,255,255,0.4)' }}>
                © 2025 Christie Stephenson Saavedra. All rights reserved.<br/>
                Original code, design, UI/UX, and demo content.
              </div>
            </div>
          </div>
        </div>
        <div className="modal-footer">
          <button className="btn btn-secondary" onClick={onClose}>Cancel</button>
          <button className="btn btn-primary" onClick={onClose}>Save Changes</button>
        </div>
      </div>
    </div>
  );
}

function CalendarView() {
  const today = new Date();
  const weekStart = new Date(today);
  weekStart.setDate(today.getDate() - today.getDay());
  
  const weekDays = [];
  for (let i = 0; i < 7; i++) {
    const day = new Date(weekStart);
    day.setDate(weekStart.getDate() + i);
    weekDays.push(day);
  }
  
  const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
  const timeSlots = ['7:00 AM', '8:00 AM', '9:00 AM', '10:00 AM', '11:00 AM', '12:00 PM', '1:00 PM', '2:00 PM', '3:00 PM', '4:00 PM'];
  
  const getBlocksForDay = (date) => {
    const dateStr = date.toISOString().split('T')[0];
    return blocks.filter(b => b.date === dateStr).slice(0, 3);
  };

  return (
    <div>
      <div className="page-header">
        <div>
          <h1 className="page-title">ðŸ“… Block Calendar</h1>
          <p className="page-subtitle">Week of {weekStart.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</p>
        </div>
        <div style={{ display: 'flex', gap: 8 }}>
          <button className="btn btn-secondary">â† Previous</button>
          <button className="btn btn-secondary">Today</button>
          <button className="btn btn-secondary">Next â†’</button>
        </div>
      </div>
      
      <div className="card no-hover" style={{ padding: 0, overflow: 'hidden' }}>
        <div style={{ display: 'grid', gridTemplateColumns: '80px repeat(7, 1fr)', borderBottom: '1px solid rgba(255,255,255,0.1)' }}>
          <div style={{ padding: 12, background: 'rgba(255,255,255,0.05)', borderRight: '1px solid rgba(255,255,255,0.1)' }}></div>
          {weekDays.map((day, i) => (
            <div key={i} style={{ 
              padding: 12, 
              textAlign: 'center', 
              background: day.toDateString() === today.toDateString() ? 'rgba(99, 102, 241, 0.2)' : 'rgba(255,255,255,0.05)',
              borderRight: i < 6 ? '1px solid rgba(255,255,255,0.1)' : 'none'
            }}>
              <div style={{ fontSize: 12, color: 'rgba(255,255,255,0.5)' }}>{dayNames[i]}</div>
              <div style={{ fontSize: 18, fontWeight: 600, color: day.toDateString() === today.toDateString() ? '#a5b4fc' : '#f8fafc' }}>{day.getDate()}</div>
            </div>
          ))}
        </div>
        
        {timeSlots.map((time, ti) => (
          <div key={ti} style={{ display: 'grid', gridTemplateColumns: '80px repeat(7, 1fr)', borderBottom: ti < timeSlots.length - 1 ? '1px solid rgba(255,255,255,0.05)' : 'none' }}>
            <div style={{ padding: '8px 12px', fontSize: 12, color: 'rgba(255,255,255,0.4)', borderRight: '1px solid rgba(255,255,255,0.1)', background: 'rgba(255,255,255,0.02)' }}>{time}</div>
            {weekDays.map((day, di) => {
              const dayBlocks = getBlocksForDay(day);
              const blockForSlot = dayBlocks.find(b => {
                const hour = parseInt(b.startTime.split(':')[0]);
                return hour === 7 + ti;
              });
              return (
                <div key={di} style={{ 
                  padding: 4, 
                  minHeight: 48,
                  borderRight: di < 6 ? '1px solid rgba(255,255,255,0.05)' : 'none',
                  background: day.getDay() === 0 || day.getDay() === 6 ? 'rgba(255,255,255,0.02)' : 'transparent'
                }}>
                  {blockForSlot && (
                    <div style={{
                      padding: '4px 8px',
                      borderRadius: 4,
                      fontSize: 11,
                      background: blockForSlot.utilization !== null 
                        ? (blockForSlot.utilization >= 80 ? 'rgba(34,197,94,0.3)' : blockForSlot.utilization >= 70 ? 'rgba(234,179,8,0.3)' : 'rgba(239,68,68,0.3)')
                        : 'rgba(59,130,246,0.3)',
                      color: '#f8fafc',
                      whiteSpace: 'nowrap',
                      overflow: 'hidden',
                      textOverflow: 'ellipsis'
                    }}>
                      {blockForSlot.room} {blockForSlot.utilization !== null ? `${blockForSlot.utilization}%` : ''}
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        ))}
      </div>
      
      <div style={{ marginTop: 24 }}>
        <h3 style={{ fontSize: 16, fontWeight: 600, marginBottom: 16 }}>Today's Blocks</h3>
        <div className="card-grid">
          {blocks.filter(b => b.date === today.toISOString().split('T')[0]).slice(0, 6).map(block => {
            const surgeon = surgeons.find(s => s.id === block.surgeonId);
            const colors = getHeatmapColor(block.utilization);
            return (
              <div key={block.id} className="card no-hover" style={{ borderLeft: `4px solid ${colors.text}` }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 8 }}>
                  <div style={{ fontWeight: 600 }}>{surgeon?.name}</div>
                  {block.utilization !== null ? (
                    <span className={`util-badge ${getUtilClass(block.utilization)}`}>{block.utilization}%</span>
                  ) : (
                    <span className="pill pill-blue">Scheduled</span>
                  )}
                </div>
                <div style={{ fontSize: 13, color: 'rgba(255,255,255,0.6)' }}>
                  {formatTime(block.startTime)} - {formatTime(block.endTime)} "¢ {block.room} "¢ {block.caseCount} cases
                </div>
              </div>
            );
          })}
          {blocks.filter(b => b.date === today.toISOString().split('T')[0]).length === 0 && (
            <div className="card no-hover" style={{ gridColumn: '1 / -1' }}>
              <div className="empty-state" style={{ padding: 24 }}>
                <div className="empty-state-icon">ðŸ“…</div>
                <div className="empty-state-title">No Blocks Today</div>
                <div className="empty-state-text">No surgical blocks are scheduled for today</div>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
}

function DashboardContent({ viewMode }) {
  const { nav, navigate } = useNavigation();
  const { isPhysician, isDirector } = useRole();
  
  if (viewMode === 'calendar') {
    return <CalendarView />;
  }

  if (isPhysician) {
    const physician = surgeons.find(s => s.id === currentUser.surgeonId);
    return physician ? (
      <div>
        <div style={{ marginBottom: 16 }}><span className="pill pill-blue">ðŸ‘¨"âš•ï¸ Physician View - Your Profile</span></div>
        <SurgeonProfile surgeon={physician} />
      </div>
    ) : <div className="empty-state"><div className="empty-state-icon">ðŸ‘¨"âš•ï¸</div><div className="empty-state-title">Profile Not Found</div></div>;
  }

  if (nav.level === 'ministries') {
    return (
      <div>
        <div className="page-header">
          <div>
            <h1 className="page-title">Ministries</h1>
            <p className="page-subtitle">Select a ministry to view hospitals</p>
            {isDirector && <span className="pill pill-blue" style={{ marginTop: 8, display: 'inline-block' }}>ðŸ“Š Read-Only View</span>}
          </div>
        </div>
        <div className="card-grid">{ministries.map(m => <MinistryCard key={m.id} ministry={m} onClick={() => navigate('hospitals', m.id)} />)}</div>
      </div>
    );
  }

  if (nav.level === 'all-hospitals') {
    return (
      <div>
        <div className="page-header"><div><h1 className="page-title">All Hospitals</h1><p className="page-subtitle">{hospitals.length} hospitals across {ministries.length} ministries</p></div></div>
        <div className="card-grid">{hospitals.map(h => <HospitalCard key={h.id} hospital={h} onClick={() => navigate('hospital-detail', h.id)} />)}</div>
      </div>
    );
  }

  if (nav.level === 'all-surgeons') {
    return (
      <div>
        <div className="page-header"><div><h1 className="page-title">All Surgeons</h1><p className="page-subtitle">{surgeons.length} surgeons across all hospitals</p></div></div>
        <div className="card-grid">{surgeons.map(s => <SurgeonCard key={s.id} surgeon={s} onClick={() => navigate('surgeon-detail', s.id)} />)}</div>
      </div>
    );
  }

  if (nav.level === 'hospitals') {
    const ministry = ministries.find(m => m.id === nav.ministryId);
    const hospList = hospitals.filter(h => h.ministryId === nav.ministryId);
    return (
      <div>
        <div className="page-header"><div><h1 className="page-title">{ministry?.name || 'Hospitals'}</h1><p className="page-subtitle">Select a hospital to choose navigation path</p></div></div>
        <div className="card-grid">{hospList.map(h => <HospitalCard key={h.id} hospital={h} onClick={() => navigate('hospital-detail', h.id)} />)}</div>
      </div>
    );
  }

  if (nav.level === 'hospital-detail') {
    const hospital = hospitals.find(h => h.id === nav.hospitalId);
    const hospSurgeons = surgeons.filter(s => s.hospitalId === nav.hospitalId);
    const hospUnits = units.filter(u => u.hospitalId === nav.hospitalId);
    if (!hospital) return <div className="empty-state">Hospital not found</div>;

    return (
      <div>
        <div className="page-header"><div><h1 className="page-title">{hospital.name}</h1><p className="page-subtitle">{hospital.location} "¢ {hospSurgeons.length} Surgeons "¢ {hospUnits.length} Units "¢ {hospital.avgUtilization}% Avg Utilization</p></div></div>
        <p style={{ marginBottom: 24, color: 'rgba(255,255,255,0.6)' }}>Choose how you want to navigate:</p>
        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: 24 }}>
          <div className="card" style={{ padding: 24, borderColor: '#93c5fd', background: 'linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(255,255,255,0.05) 100%)' }} onClick={() => navigate('surgeons', nav.hospitalId)}>
            <div style={{ display: 'flex', alignItems: 'center', gap: 16, marginBottom: 16 }}>
              <div style={{ width: 56, height: 56, background: 'rgba(59, 130, 246, 0.2)', borderRadius: 12, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: 28 }}>ðŸ‘¨"âš•ï¸</div>
              <div><h3 style={{ fontSize: 18, fontWeight: 600, color: '#93c5fd' }}>View by Surgeon</h3><p style={{ fontSize: 13, color: '#60a5fa' }}>Surgeon-First Navigation</p></div>
            </div>
            <p style={{ color: 'rgba(255,255,255,0.6)', marginBottom: 16 }}>See all surgeons at this hospital with their blocks, tiers, and utilization metrics.</p>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', paddingTop: 16, borderTop: '1px solid rgba(255,255,255,0.1)' }}>
              <span style={{ fontSize: 14, color: 'rgba(255,255,255,0.5)' }}>{hospSurgeons.length} surgeons</span>
              <span style={{ color: '#60a5fa', fontWeight: 500 }}>View Surgeons â†’</span>
            </div>
          </div>
          <div className="card" style={{ padding: 24, borderColor: '#5eead4', background: 'linear-gradient(135deg, rgba(20, 184, 166, 0.1) 0%, rgba(255,255,255,0.05) 100%)' }} onClick={() => navigate('units', nav.hospitalId)}>
            <div style={{ display: 'flex', alignItems: 'center', gap: 16, marginBottom: 16 }}>
              <div style={{ width: 56, height: 56, background: 'rgba(20, 184, 166, 0.2)', borderRadius: 12, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: 28 }}>ðŸ¥</div>
              <div><h3 style={{ fontSize: 18, fontWeight: 600, color: '#5eead4' }}>View by Unit</h3><p style={{ fontSize: 13, color: '#2dd4bf' }}>Unit-First Navigation</p></div>
            </div>
            <p style={{ color: 'rgba(255,255,255,0.6)', marginBottom: 16 }}>Browse surgical units and their block calendars with surgeon filtering.</p>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', paddingTop: 16, borderTop: '1px solid rgba(255,255,255,0.1)' }}>
              <span style={{ fontSize: 14, color: 'rgba(255,255,255,0.5)' }}>{hospUnits.length} units</span>
              <span style={{ color: '#2dd4bf', fontWeight: 500 }}>View Units â†’</span>
            </div>
          </div>
        </div>
        <h3 style={{ fontSize: 16, fontWeight: 600, marginTop: 32, marginBottom: 16 }}>Hospital Overview</h3>
        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: 16 }}>
          <div className="card no-hover" style={{ padding: 16, textAlign: 'center' }}><div className="stat-value">{hospital.surgeonCount}</div><div className="stat-label">Surgeons</div></div>
          <div className="card no-hover" style={{ padding: 16, textAlign: 'center' }}><div className="stat-value">{hospital.unitCount}</div><div className="stat-label">Units</div></div>
          <div className="card no-hover" style={{ padding: 16, textAlign: 'center' }}><div className="stat-value">{hospital.roomCount}</div><div className="stat-label">Rooms</div></div>
          <div className="card no-hover" style={{ padding: 16, textAlign: 'center' }}><div className="stat-value" style={{ color: hospital.avgUtilization >= 80 ? '#4ade80' : hospital.avgUtilization >= 70 ? '#facc15' : '#f87171' }}>{hospital.avgUtilization}%</div><div className="stat-label">Utilization</div></div>
        </div>
      </div>
    );
  }

  if (nav.level === 'surgeons') {
    const hospital = hospitals.find(h => h.id === nav.hospitalId);
    const surgeonList = surgeons.filter(s => s.hospitalId === nav.hospitalId);
    return (
      <div>
        <div className="page-header"><div><h1 className="page-title">Surgeons</h1><p className="page-subtitle">{hospital?.name} "¢ {surgeonList.length} surgeons</p></div></div>
        <div className="card-grid">{surgeonList.map(s => <SurgeonCard key={s.id} surgeon={s} onClick={() => navigate('surgeon-detail', s.id)} />)}</div>
      </div>
    );
  }

  if (nav.level === 'units') {
    const hospital = hospitals.find(h => h.id === nav.hospitalId);
    const unitList = units.filter(u => u.hospitalId === nav.hospitalId);
    return (
      <div>
        <div className="page-header"><div><h1 className="page-title">Units</h1><p className="page-subtitle">{hospital?.name} "¢ {unitList.length} units</p></div></div>
        <div className="card-grid">{unitList.map(u => <UnitCard key={u.id} unit={u} onClick={() => alert(`Unit: ${u.name}\n\nThis unit has ${u.surgeonCount} surgeons and ${u.roomCount} operating rooms.\n\nIn the full application, clicking would show the unit's block schedule and surgeon assignments.`)} />)}</div>
      </div>
    );
  }

  if (nav.level === 'surgeon-detail') {
    const surgeon = surgeons.find(s => s.id === nav.surgeonId);
    return surgeon ? <SurgeonProfile surgeon={surgeon} /> : <div className="empty-state"><div className="empty-state-icon">ðŸ”</div><div className="empty-state-title">Surgeon Not Found</div></div>;
  }

  return null;
}

function App() {
  const [viewMode, setViewMode] = useState('explorer');
  const [showSearch, setShowSearch] = useState(false);
  const [showHeatMap, setShowHeatMap] = useState(false);
  const [showSettings, setShowSettings] = useState(false);

  return (
    <RoleProvider>
      <NavigationProvider>
        <div>
          <Header viewMode={viewMode} onViewModeChange={setViewMode} onSearchOpen={() => setShowSearch(true)} onHeatMapOpen={() => setShowHeatMap(true)} onSettingsOpen={() => setShowSettings(true)} />
          <Sidebar onSettingsOpen={() => setShowSettings(true)} />
          <main className="main">
            <div className="content">
              <Breadcrumb />
              <DashboardContent viewMode={viewMode} />
            </div>
          </main>

          {showSearch && (
            <div className="modal-overlay" onClick={() => setShowSearch(false)}>
              <div className="modal" onClick={e => e.stopPropagation()}>
                <div className="modal-header"><div className="modal-title">ðŸ” Search</div><button className="modal-close" onClick={() => setShowSearch(false)}>Ã—</button></div>
                <div className="modal-body">
                  <input type="text" className="form-input" placeholder="Search surgeons, hospitals, blocks..." autoFocus />
                  <div style={{ marginTop: 24 }}>
                    <div style={{ fontSize: 12, color: 'rgba(255,255,255,0.4)', marginBottom: 12 }}>QUICK FILTERS</div>
                    <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap' }}>
                      <span className="pill pill-blue">ðŸ¥ Hospitals</span>
                      <span className="pill pill-blue">ðŸ‘¨"âš•ï¸ Surgeons</span>
                      <span className="pill pill-blue">ðŸ“… Blocks</span>
                      <span className="pill pill-blue">âš–ï¸ Disputes</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {showHeatMap && (
            <div className="modal-overlay" onClick={() => setShowHeatMap(false)}>
              <div className="modal xlarge" onClick={e => e.stopPropagation()}>
                <div className="modal-header"><div className="modal-title">ðŸ“Š Heat Map</div><button className="modal-close" onClick={() => setShowHeatMap(false)}>Ã—</button></div>
                <div className="modal-body">
                  <div style={{ marginBottom: 24 }}>
                    <div style={{ fontSize: 12, color: 'rgba(255,255,255,0.4)', marginBottom: 12 }}>DRILL-DOWN LEVELS</div>
                    <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap' }}>
                      <span className="pill pill-blue">ðŸ›ï¸ Ministry</span>
                      <span className="breadcrumb-sep">â†’</span>
                      <span className="pill pill-blue">ðŸ¥ Hospital</span>
                      <span className="breadcrumb-sep">â†’</span>
                      <span className="pill pill-blue">ðŸ¥ Unit</span>
                      <span className="breadcrumb-sep">â†’</span>
                      <span className="pill pill-blue">ðŸšª Room</span>
                      <span className="breadcrumb-sep">â†’</span>
                      <span className="pill pill-blue">ðŸ“… Calendar</span>
                    </div>
                  </div>
                  <div className="empty-state"><div className="empty-state-icon">ðŸ“Š</div><div className="empty-state-title">6-Level Heat Map</div><div className="empty-state-text">Interactive drill-down visualization from Ministry to Calendar</div></div>
                </div>
              </div>
            </div>
          )}

          {showSettings && <SettingsModal onClose={() => setShowSettings(false)} />}
        </div>
      </NavigationProvider>
    </RoleProvider>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
